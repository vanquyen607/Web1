<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="../css/dangnhap.css">
    <!-- <link rel="stylesheet" href="../js/dangnhap.js"> -->
    <!-- <link rel="stylesheet" href="./assets/font/themify-icons/themify-icons.css"> -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" />    

</head>
<script>
    

    
    function checkdangnhap(e) {
        
        event.preventDefault();
        var username = document.getElementById('username').value;
        var password = document.getElementById('password').value;
        if(!username || !password)
        {
            alert("Vui lÃ²ng Ä‘iá»n Ä‘áº§y Ä‘á»§ thÃ´ng tin Ä‘Äƒng nháº­p!");
            return false;
        }

        if(username=='admin' && password=='admin') //ADMIN
                {
                    alert('Welcome admin ^^');
                    // Sau khi Ä‘Äƒng nháº­p thÃ nh cÃ´ng
                    localStorage.setItem('loggedIn', true); //Trang thai dang nhap 
                    localStorage.setItem('currentUser', username); // LÆ°u tÃªn ngÆ°á»i dÃ¹ng hiá»‡n táº¡i (tÃ¹y chá»n)

                    window.location.href = "./base.html";
                    return true;
                }

        var usersDataArray = JSON.parse(localStorage.getItem('usersDataArray'));
        if(usersDataArray)
        {
        
            for(i=0;i<usersDataArray.length;i++)
            {
    
                if(usersDataArray[i].username === username && usersDataArray[i].password === password)
                {
        
                    var id=i; //Luu lai id cua user
                    alert('ÄÄƒng nháº­p thÃ nh cÃ´ng ');
                    // Sau khi Ä‘Äƒng nháº­p thÃ nh cÃ´ng
                    localStorage.setItem('loggedIn', true); //Trang thai dang nhap
                    localStorage.setItem('currentUser', username); // LÆ°u tÃªn ngÆ°á»i dÃ¹ng hiá»‡n táº¡i (tÃ¹y chá»n)
                    var userlogin = { 
                                userId: usersDataArray[id].userId,
                                username: username,
                                password: password ,
                                email: usersDataArray[id].email ,
                                address: usersDataArray[id].address,
                                fullname: usersDataArray[id].fullname,
                                phonenumber: usersDataArray[id].phonenumber        
                                };

                    localStorage.setItem('userLogin',JSON.stringify(userlogin));    // Luu lai thong tin dang nhap user
                    window.location.href = "./base.html";
                    return true;
                }
                
                
            }
                    alert('Username hoáº·c password khÃ´ng Ä‘Ãºng!');
                    return false;
            
            // console.log(usersDataArray);
        }
        else{
            alert("TÃ i khoáº£n khÃ´ng tá»“n táº¡i!");
            return false;
        }
        return true;
    }

    function togglePasswordVisibility() {
      var passwordInput = document.getElementById('password');
      var showPasswordIcon = document.getElementById('showPasswordIcon');

      // Thay Ä‘á»•i thuá»™c tÃ­nh type cá»§a trÆ°á»ng máº­t kháº©u
      if (passwordInput.type === "password") {
        passwordInput.type = "text";
        showPasswordIcon.textContent = "ğŸ‘ï¸"; // Khi hiá»ƒn thá»‹ máº­t kháº©u, báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng emoji khÃ¡c
      } else {
        passwordInput.type = "text";
        passwordInput.type = "password";
        showPasswordIcon.textContent = "ğŸ‘ï¸"; // Khi áº©n máº­t kháº©u, báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng emoji khÃ¡c
      }
    }

    // Quen mat khau
    function refershpass(){
        // alert("Chá»©c nÄƒng Ä‘ang phÃ¡t triá»ƒn !");
        document.querySelector(".modal-fogotpass").style.display = "flex";

    }

    function closefogotpass(){
        document.querySelector(".modal-fogotpass").style.display = "none";
    }

    function updatepass(e){
        event.preventDefault();
        var usersDataArray = JSON.parse(localStorage.getItem('usersDataArray'));
        var username=document.getElementById('username-fogot').value;
        var password=document.getElementById('password-fogot').value;
        var repassword=document.getElementById('repassword-fogot').value;

        if(!username || !password || !repassword){
            alert('Vui lÃ²ng Ä‘iá»n Ä‘á»§ thÃ´ng tin');
            return false;
        }
        if(password !== repassword) {
            alert("Máº­t kháº©u má»›i khÃ´ng khá»›p");
            return false;
        }

        
        if(usersDataArray){
            for(var i = 0; i < usersDataArray.length;i++)
            {
                if(usersDataArray[i].username===username){
                    // console.log("username");
                    usersDataArray[i].password=password;
                    localStorage.setItem('usersDataArray', JSON.stringify(usersDataArray));
                    alert("ÄÃ£ cáº­p nháº­t thÃ nh cÃ´ng");
                    document.querySelector(".modal-fogotpass").style.display = "none";
                    return true;
                }
            }
            alert("Username khÃ´ng Ä‘Ãºng !");
            return false;
            
        }
        else{
            alert("Vui lÃ²ng Ä‘Äƒng kÃ­ tÃ i khoáº£n ! ");
            return false;
        }

    }

</script>
<body>
    <div class="wapper-dangnhap">

        <form action=""  onsubmit="checkdangnhap();" name="form-dangnhap">

                <h1>ÄÄ‚NG NHáº¬P</h1>

                <div class="input">

                    <div class="input-form">
                        <span class="text">Username</span>
                        <input type="text" id="username" name="" class="input-box">
                    </div>



                    <div class="input-form">
                        <span  class="text">Password</span>
                        <input type="password" id="password" name="" class="input-box">
                        <span id="showPasswordIcon" onclick="togglePasswordVisibility()">ğŸ‘ï¸</span>

                    </div>
    
                    
                    <a class="forgot" onclick="refershpass();">QuÃªn máº­t kháº©u ?</a>

                </div>

                
                <div class="icon">
                    <a href=""><i class="icon-item fab fa-facebook"></i></a>
                    <a href=""><i class="icon-item fab fa-twitter"></i></a>
                    <a href=""><i class="icon-item fab fa-google"></i></a>
                </div>

                <span>Trá»Ÿ láº¡i trang Ä‘Äƒng kÃ­ ?<a href="./dangki.html"> ÄÄƒng kÃ­ </a></span>
                
                
                <div class="form-btn">
                    <button type="submit"  name="" class="btn-dangky">ÄÄ‚NG NHáº¬P</button>
                </div>

                <p><a href="./base.html">TRANG CHá»¦</a></p>

           
        </form>
    </div>


    <div class="modal-fogotpass"  style="display: none;">
            
        <div class="container-fogotpass">
            <div class="header-fogotpass">
                QuÃªn máº­t kháº©u
                <div class="close-formdon" onclick="closefogotpass();" >
                    <i class=" icon-close fas fa-window-close"></i>
                </div>
            </div>
            

            <hr>

            <div class="body-fogotpass">
                <div class="input-form">
                    <span class="text">Username</span>
                    <input type="text" id="username-fogot" name="" class="input-box">
                </div>
                <div class="input-form">
                    <span  class="text">Password</span>
                    <input type="password" id="password-fogot" name="" class="input-box">
                    
                </div>
                <div class="input-form">
                    <span  class="text">Repassword</span>
                    <input type="password" id="repassword-fogot" name="" class="input-box">
                    
                </div>
            </div>

            <div class="btnmodal-fogotpass">
                <button type="button" class="btn-fogotpass" onclick="updatepass();">Cáº­p nháº­t máº­t kháº©u</button>
            </div>
        </div>

    </div>

</body>
</html>